# -----------------------------------------------------------------------------
# App1 Deployment + Service
# - Runs 1 replica of ealen/echo-server
# - Service exposes it internally on port 80
# -----------------------------------------------------------------------------
apiVersion: apps/v1
kind: Deployment
metadata:
  name: app1
  namespace: webapps
spec:
  replicas: 1                  # Only 1 replica required
  selector:
    matchLabels: { app: app1 } # Match pods with label app=app1
  template:
    metadata:
      labels: { app: app1 }    # Pod label must match Service selector
    spec:
      containers:
        - name: echo
          image: docker.io/ealen/echo-server:latest  # Simple echo server
          ports:
            - containerPort: 80  # Pod listens on port 80
---
apiVersion: v1
kind: Service
metadata:
  name: app1
  namespace: webapps
spec:
  selector: { app: app1 }     # Routes traffic to pods with app=app1
  ports:
    - name: http
      port: 80                # ClusterIP service port
      targetPort: 80          # Forward to pod port
